---
import type { HTMLAttributes } from "astro/types";
import "./index.css";

export type Props = HTMLAttributes<"figure"> & {
  caption?: string;
  cssClasses?: Array<string>;
  index?: number;
  isIndexed?: boolean;
};

const { caption, cssClasses = [], index, isIndexed, ...attrs } = Astro.props;

const indexed = isIndexed ? { class: "indexed" } : {};
const cap = caption ? caption : await Astro.slots.render("caption");
const css = ["sb-figure", ...cssClasses].join(" ");
---

<figure class={css} {...indexed} {...attrs}>
  {
    cap && (
      <figcaption>
        {index ? `Figure ${index}: ` : ""}
        <Fragment set:html={cap} />
      </figcaption>
    )
  }
  <slot />
</figure>
