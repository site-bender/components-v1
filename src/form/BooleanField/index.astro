---
import FieldWrapper from "../FieldWrapper/index.astro";
import generateShortId from "../../utilities/generateShortId";
import mapDataset from "../../utilities/mapDataset";
import type { Dataset } from "../../types";
import type { HTMLAttributes } from "astro/types";
import "./index.css";

export type Props = HTMLAttributes<"input"> & {
  dataset?: Dataset;
  label?: string;
  name: string;
  value?: string;
};

const {
  dataset,
  id = `_${generateShortId()}`,
  label,
  value,
  ...attrs
} = Astro.props;

const labelId = `${id}-label`;
const data = mapDataset(dataset);
const lbl = label || (await Astro.slots.render("default")) || "Yes";
---

<FieldWrapper
  fieldType="sb-boolean"
  id={id as string}
  label={lbl}
  labelId={labelId}
  name={attrs.name}
  {...attrs.required ? { required: true } : {}}
  wrapInput
>
  <Fragment slot="element">
    <input
      aria-labelledBy={labelId}
      class="sb-boolean-input"
      {...data}
      id={id as string}
      {...attrs}
      type="checkbox"
      {...value ? { value } : {}}
    />
  </Fragment>
</FieldWrapper>
